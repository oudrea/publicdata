MATCH (n:Entity {file_source: 'shodan_keyword_to_guid'}) - [:NAMEVARIANT|ADDRESS] - (nv) WHERE (nv.rowIndex <> '-1') WITH nv, n MATCH (n) - [:NAMEVARIANT] - (c:Caption) WITH nv, n, c.guid as guid, c.caption_name as caption RETURN nv.rowIndex as lineno, coalesce(collect(nv.keyword)[0],'') as keyword, coalesce(collect(nv.caption_name)[0],caption) as caption_name, coalesce(collect(nv.guid)[0],guid) as guid, coalesce(collect(nv.address)[0],'') as address, coalesce(collect(nv.coordinates)[0],'') as coordinates;